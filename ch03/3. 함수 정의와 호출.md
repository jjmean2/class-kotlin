<!-- $size: B4 -->

# 3. 함수의 정의와 호출

---

* 컬렉션, 문자열, 정규식을 다루기 위한 함수
* 이름 붙인 인자, 디폴트 파라미터 값, 중위 호출 문법 사용
* 확장 함수와 확장 프로퍼티를 사용해 자바 라이브러리 적용
* 최상위 및 로컬 함수와 프로퍼티를 사용해 코드 구조화

---

1. 함수 정의와 호출
2. 확장 함수와 프로퍼티

---

# 컬렉션 만들기

---

# 컬렉션 만들기

```kotlin
val set = hashSetOf(1, 7, 53)
// java.util.HashSet

val list = arrayListOf(1, 7, 53)
// java.util.ArrayList

val map = hashMapOf(1 to "one", 7 to "seven", 53 to "fifty-three")
// java.util.HashMap
```

**Kotlin의 컬렉션은 Java의 컬렉션을 그대로 사용한다**

---

# 컬렉션 만들기

```kotlin
val strings = listOf("first", "second", "fourteenth")

println(strings.last())

// fourteenth
```

```kotlin
val numbers = setOf(1, 14, 2)

println(numbers.max())

// 14
```

**Kotlin은 기존의 컬렉션에는 없는 메소드들을 추가로 지원한다.**

---

# joinToString()

```kotlin
val list = listOf(1, 2, 3)

println(list)	// toString() 호출

// [1, 2, 3]
```
다른 형식으로 출력하고 싶다면? 
새로운 함수를 정의하자. 

---

# joinToString()

```kotlin
fun <T> joinToString(
        collection: Collection<T>,
        separator: String,
        prefix: String,
        postfix: String
): String {
    
    val result = StringBuilder(prefix)
    
    for ((index, element) in collection.withIndex()) {
        if (index > 0) result.append(separator)
        result.append(element)
    }
    
    result.append(postfix)
    
    return result.toString()
}
```

--- 
# joinToString()

### Java

```java
<T> String joinToString(
        Collection<T> collection,
        String separator,
        String prefix,
        String postfix) {

    StringBuilder result = new StringBuilder(prefix);
    Iterator<T> iter = collection.iterator();
    int index = -1;
    while (iter.hasNext()) {
        index++;
        if (index > 0) result.append(separator);
        result.append(iter.next());
    }
    result.append(postfix);

    return result.toString();
}
```

---

# joinToString()

### Java
```java
<T> String joinToString(
        Collection<T> collection,
        String separator,
        String prefix,
        String postfix
)
```

### Kotlin
```kotlin
fun <T> joinToString(
        collection: Collection<T>,
        separator: String,
        prefix: String,
        postfix: String
): String 
```

---

# joinToString()

### Java
```java
StringBuilder result = new StringBuilder(prefix);
Iterator<T> iter = collection.iterator();

int index = -1;
while (iter.hasNext()) {
    index++;
    if (index > 0) result.append(separator);
    result.append(iter.next());
}
result.append(postfix);

return result.toString();
```

### Kotlin
```kotlin
val result = StringBuilder(prefix)

for ((index, element) in collection.withIndex()) {
    if (index > 0) result.append(separator)
    result.append(element)
}
result.append(postfix)
    
return result.toString()
```

---

# joinToString()

```kotlin
val list = listOf(1, 2, 3)

println(joinToString(list, "; ", "(", ")"))

// (1; 2; 3)
```

![](./intellij_java_joinToString.png)


---
# joinToString()

### 되는 것
```kotlin
joinToString(list, separator = "; ", prefix = "(", postfix = ")")

joinToString(list, postfix = ")", prefix = "(", separator = "; ")

joinToString(list, "; " ,prefix ="(", postfix = ")")
```

### 안 되는 것
```kotlin
joinToString(list, "(", separator = ";",  postfix = ")")	
// An argument is already passed for this parameter 

joinToString(list, ";", prefix ="(", ")")
// Mixing named and positioned arguments is not allowed

```

---

# 디폴트 파라미터

```kotlin
fun <T> joinToString(
        collection: Collection<T>,
        separator: String = ",",
        prefix: String = "",
        postfix: String = ""
): String
```
---

# 디폴트 파라미터

```kotlin
joinToString(list, ", ", "", "")
// 1, 2, 3

joinToString(list)
// 1, 2, 3

joinToString(list, "; ")
// 1; 2; 3

joinToString(list, postfix = ";", prefix = "# ")
// # 1, 2, 3;

```

---

# 디폴트 파라미터

#### Java에서 디폴트 파라미터를 지원하려면? 
메소드 오버로딩

```java
<T> String joinToString(
        Collection<T> collection,
        String separator,
        String prefix,
        String postfix) { ... }
        

<T> String joinToString(
        Collection<T> collection,
        String separator,
        String prefix) { 
        return joinToString(collection, separator, prefix, "");
}

<T> String joinToString(
        Collection<T> collection,
        String separator) { 
        return joinToString(collection, separator, "", "");
}

<T> String joinToString(
        Collection<T> collection) { 
        return joinToString(collection, ", ", "", "");
}
```

---

# 디폴트 파라미터

#### Java에서 디폴트 파라미터를 지원하려면? 
메소드 오버로딩

##### 가능
```java
joinToString(list, ", ", "", "")
// 1, 2, 3

joinToString(list)
// 1, 2, 3

joinToString(list, "; ")
// 1; 2; 3
```

##### 불가능
```java
joinToString(list, postfix = ";", prefix = "# ")
// # 1, 2, 3;
```

___

# 최상위 함수, 최상위 프로퍼티
```kotlin
// join.kt

package strings

fun joinToString(...): String {
	...
}
```

```kotlin
// main.kt
import strings.joinToString

fun main(args: Array<String>) {
    val list = listOf(1, 2, 3)
    println(joinToString(list))
}
```

---
# 최상위 함수, 최상위 프로퍼티

```java
// join.kt의 Java 버전

package strings;

public class JoinKt {
    public static String joinToString(...) {
        ...
    }
}
```

```java
import strings.JoinKt;

...
JoinKt.joinToString(list, ", ", "", "");
```

```java
import static strings.JoinKt.joinToString;

...
joinToString(list, ", ", "", "");
```

--- 
# 최상위 함수, 최상위 프로퍼티

```kotlin
// operation.kt

var opCount = 0

fun performOperation() {
    opCount++
}

fun reportOperationCount() {
    println("Operation performed $opCount times")
}
```

```kotlin
// main.kt

fun main(args: Array<String>) {
    opCount = 30
    println(opCount)
}
```
**같은 패키지 내에서는 어디서나 호출가능**
**다른 패키지라면 import하거나 full name을 이용하여 호출가능**

--- 
# 최상위 함수, 최상위 프로퍼티

```java
// operation.kt의 Java 버전

public class OperationKt {

    private static int opCount;
    
    public static int getOpCount() { 
        return opCount; 
    }
    
    public static void setOpCount(int opCount) { 
        this.opCount = opCount
    }
    ...
}
```
```java
// main.kt의 Java 버전
public class MainKt {

    public static void main(String[] args) {
    
        OperationKt.setOpCount(30);
        System.out.println(OperationKt.getOpCount());
    }
}
```
**기본적으로 getter와 setter가 생성됨**

--- 
# 최상위 함수, 최상위 프로퍼티

##### Kotlin
```kotlin
// constants.kt

val UNIX_LINE_SEPARATOR = "\n"
```

##### Java
```java
// constants.kt의 Java 버전

public class ConstantsKt {

    private static final String UNIX_LINE_SEPARATOR = "\n";
    
    public static String getUNIX_LINE_SEPARATOR() {
        return getUNIX_LINE_SEPARATOR;
    }
}
	
```
**상수(`val`)로 정의한 최상위 프로퍼티는 private 변수와 getter로 변환된다.**


--- 

# 최상위 함수, 최상위 프로퍼티

##### Kotlin
```kotlin
// const를 사용한 constants.kt

const val UNIX_LINE_SEPARATOR = "\n"
```

##### Java
```java
// const를 사용한 constants.kt의 Java 버전

public class ConstantsKt {

   public static final String UNIX_LINE_SEPARATOR = "\n";
}
	
```
**val 상수 앞에 const를 붙이면 private 변수와 getter 대신에 public static final 변수를 만든다.**
**`var` 변수 앞에는 `const`를 붙일 수 없다.**
**`const`는 Top Level이나 object의 프로퍼티에만 붙일 수 있다. (class 안에는 올 수 없다.)

---

# 확장 함수, 확장 프로퍼티
* 어떤 클래스의 멤버 메소드, 멤버변수인 것처럼 호출할 수 있는 함수, 프로퍼티
* 실제로는 그 클래스 밖에 선언됨
* 내가 작성하지 않은 클래스에 대해 메소드와 프로퍼티를 추가할 수 있음

---

# 확장 함수, 확장 프로퍼티
##### 확장 함수 정의
```kotlin
package strings

fun String.lastChar(): Char = this.get(this.length - 1)
```
* `String`은 수신 객체 타입 (Receiver type)
* `this`는 수신 객체 (Receiver object)

##### 확장 함수 사용
```kotlin
println("Kotlin".lastChar())
```

---
# 확장 함수, 확장 프로퍼티
```kotlin
package strings

fun String.lastChar(): Char = this.get(this.length - 1)
```
* 일반적인 클래스의 메소드를 정의할 때와 같이 본문에서 `this`를 사용할 수 있다.

```kotlin
package strings

fun String.lastChar(): Char = get(length - 1)
```
* `this`를 생략할 수도 있다.

### But
* 확장함수 내에서는 클래스의 private 멤버나 protected 멤버를 사용할 수 없다. 
  (밖에서 접근불가한 멤버는 사용불가)

---

# 확장 함수, 확장 프로퍼티

```java
public class CollectionsKt {
   public static char lastChar(String receiver) {
      return $receiver.charAt(receiver.length() - 1);
   }
}
```
